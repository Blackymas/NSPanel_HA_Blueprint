# -----------------------------------------------------------------------------
# Stale Issues & PRs Management
# -----------------------------------------------------------------------------
# Automatically marks issues/PRs as stale after inactivity, and closes them
# if no further activity occurs. Any new comment or update resets the counters.
# -----------------------------------------------------------------------------
---
name: Close stale issues and PRs

# yamllint disable-line rule:truthy
on:
  schedule:
    # Run daily at 01:30 UTC
    - cron: '30 1 * * *'
  workflow_dispatch:

jobs:
  stale:
    runs-on: ubuntu-latest

    permissions:
      issues: write
      pull-requests: write

    steps:
      - uses: actions/stale@v10
        with:
          # ---------------------------------------------------------------
          # Issue configuration
          # ---------------------------------------------------------------
          days-before-issue-stale: 180  # Days of inactivity before marking stale
          days-before-issue-close: 14   # Days after stale label before closing
          stale-issue-label: 'stale'
          stale-issue-message: >
            This issue has been automatically marked as stale because it has
            not had recent activity. It will be closed in 14 days if no further
            activity occurs. Thank you for your contributions!
          close-issue-message: >
            This issue was closed because it has been inactive for 14 days
            since being marked as stale.

          # ---------------------------------------------------------------
          # Pull Request configuration
          # ---------------------------------------------------------------
          days-before-pr-stale: 30  # Days of inactivity before marking stale
          days-before-pr-close: 14  # Days after stale label before closing
          stale-pr-label: 'stale'
          stale-pr-message: >
            This pull request has been automatically marked as stale because
            it has not had recent activity. It will be closed in 14 days if
            no further activity occurs. Thank you for your contributions!
          close-pr-message: >
            This pull request was closed because it has been inactive for 14
            days since being marked as stale.

          # ---------------------------------------------------------------
          # Exemptions - labels that prevent stale processing
          # ---------------------------------------------------------------
          exempt-issue-labels: 'blocked,help-wanted,long-term,not-stale,pinned,security,work in progress'
          exempt-pr-labels: 'blocked,help-wanted,long-term,not-stale,pinned,security,work in progress'

          # ---------------------------------------------------------------
          # Optional: Don't close PRs with assignees (active review)
          # ---------------------------------------------------------------
          # exempt-all-pr-assignees: true

          # ---------------------------------------------------------------
          # Rate limiting - max operations per run (default: 30)
          # ---------------------------------------------------------------
          operations-per-run: 250

          repo-token: ${{ secrets.GITHUB_TOKEN }}
...
