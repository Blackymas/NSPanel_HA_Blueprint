Page boot
    Attributes
        ID                 : 0
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Locked             : no
        Swide up page ID   : disabled
        Swide down page ID : disabled
        Swide left page ID : disabled
        Swide right page ID: disabled
    
    Events
        Preinitialize Event
            dim=100
            ver_tft.txt="TFT: "+version.txt
            click sys_baudrate,1
        
Variable (string) version
    Attributes
        ID            : 7
        Scope         : global
        Text          : 4.4.0.dev3
        Max. Text Size: 16
    
Variable (int32) log_len
    Attributes
        ID   : 17
        Scope: local
        Value: 0
    
Variable (int32) log_pos
    Attributes
        ID   : 18
        Scope: local
        Value: 0
    
Variable (int32) log_line_count
    Attributes
        ID   : 19
        Scope: local
        Value: 0
    
Variable (int32) log_start_pos
    Attributes
        ID   : 20
        Scope: local
        Value: 0
    
Variable (int32) log_end_pos
    Attributes
        ID   : 21
        Scope: local
        Value: 0
    
Variable (string) log_temp
    Attributes
        ID            : 22
        Scope         : local
        Text          : 
        Max. Text Size: 2
    
Variable (string) tmp_baudrate
    Attributes
        ID            : 24
        Scope         : local
        Text          : 
        Max. Text Size: 8
    
Variable (int32) log_max_lines
    Attributes
        ID   : 25
        Scope: local
        Value: 14
    
Variable (int32) counter
    Attributes
        ID   : 26
        Scope: local
        Value: 0
    
Variable (string) json
    Attributes
        ID            : 28
        Scope         : local
        Text          : 
        Max. Text Size: 100
    
Variable (string) num_to_str
    Attributes
        ID            : 29
        Scope         : local
        Text          : 
        Max. Text Size: 10
    
Text log_body
    Attributes
        ID                 : 2
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : 
        Max. Text Size     : 1000
    
Text initializing
    Attributes
        ID                 : 3
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Initializing...
        Max. Text Size     : 15
    
Text ver_box
    Attributes
        ID                 : 4
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : 
        Max. Text Size     : 0
    
Text ver_title
    Attributes
        ID                 : 5
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               :  Versions
        Max. Text Size     : 9
    
Text ver_tft
    Attributes
        ID                 : 6
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : TFT: Waiting...
        Max. Text Size     : 25
    
Text ver_firmware
    Attributes
        ID                 : 8
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Firmware: Waiting...
        Max. Text Size     : 30
    
Text ver_blueprint
    Attributes
        ID                 : 9
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Blueprint: Waiting...
        Max. Text Size     : 30
    
Text sys_box
    Attributes
        ID                 : 10
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : 
        Max. Text Size     : 0
    
Text sys_title
    Attributes
        ID                 : 11
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               :  System
        Max. Text Size     : 9
    
Text sys_ip
    Attributes
        ID                 : 12
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : IP: Waiting...
        Max. Text Size     : 20
    
Text sys_framework
    Attributes
        ID                 : 13
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Framework: Waiting...
        Max. Text Size     : 30
    
Text sys_baudrate
    Attributes
        ID                 : 14
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Baud rate: Waiting...
        Max. Text Size     : 30
    
    Events
        Touch Press Event
            covx baud,tmp_baudrate.txt,0,0
            sys_baudrate.txt="Baud rate: "
            sys_baudrate.txt+=tmp_baudrate.txt
            sys_baudrate.txt+=" bps"
        
Text log_box
    Attributes
        ID                 : 15
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : 
        Max. Text Size     : 0
    
    Events
        Touch Press Event
            strlen log_body.txt,log_len.val
            log_pos.val=0
            log_line_count.val=0
            log_start_pos.val=0
            log_end_pos.val=0
            log_temp.txt=""
            // Count the number of lines (instances of \r)
            while(log_pos.val<log_len.val)
            {
                // Extract each character to find \r
                substr log_body.txt,log_temp.txt,log_pos.val,2
                if(log_temp.txt=="\r")
                {
                    log_line_count.val++
                    // Record the position of the first \r
                    if(log_line_count.val==1)
                    {
                        log_start_pos.val=log_pos.val
                    }
                    // Record the position of the second \r
                    if(log_line_count.val==2)
                    {
                        log_end_pos.val=log_pos.val
                    }
                    doevents
                }
                log_pos.val++
            }
            // Check if the number of lines exceeds the maximum allowed
            while(log_line_count.val>log_max_lines.val)
            {
                // If more than max_lines, remove the first line
                if(log_end_pos.val>0)
                {
                    // Remove the first line including the newline character
                    substr log_body.txt,log_body.txt,log_start_pos.val+2,log_len.val-log_start_pos.val-2
                }
                log_line_count.val--
                doevents
            }
        
Text log_title
    Attributes
        ID                 : 16
        Scope              : local
        Dragging           : 0
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               :  Log
        Max. Text Size     : 9
    
Progress Bar progress
    Attributes
        ID               : 1
        Scope            : global
        Dragging         : 0
        Send Component ID: disabled
        Value            : 0
    
Dual-state Button bt_reboot
    Attributes
        ID               : 23
        Scope            : local
        Dragging         : 0
        Send Component ID: on press and release
        State            : unpressed
        Text             : Reboot
        Max. Text Size   : 6
    
    Events
        Touch Release Event
            log_body.txt+="Click button 'Reboot'\r"
            if(api==0)
            {
                rest
            }
        
Timer tm_esphome
    Attributes
        ID         : 27
        Scope      : local
        Period (ms): 1000
        Enabled    : yes
    
    Events
        Timer Event
            printh 92
            prints "current_page",0
            printh 00
            prints "boot",0
            printh 00
            printh FF FF FF
            counter.val++
            if(counter.val>360)
            {
                rest
            }
            sys0=counter.val%60
            if(sys0==0)
            {
                bauds=115200
            }
            click sys_baudrate,1
            doevents
            json.txt="{\"event\":\"params\""
            covx display_mode,num_to_str.txt,0,0
            json.txt+=",\"display_mode\":"+num_to_str.txt
            covx charset,num_to_str.txt,0,0
            json.txt+=",\"charset\":"+num_to_str.txt
            json.txt+=",\"version\":\""+version.txt+"\""
            json.txt+="}"
            printh 92
            prints "localevent",0
            printh 00
            prints json.txt,0
            printh 00
            printh FF FF FF
        
